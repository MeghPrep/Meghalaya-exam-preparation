<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quiz</title>
<style>

:root{
  --bg:#060606;
  --card-bg:#0f1113;
  --card-ink:#e6eef2;
  --muted:#a9b0b6;
  --accent-hover: rgba(100,160,255,0.12); /* soft blue hover */
  --accent-hover-strong: rgba(100,160,255,0.22);
  --correct-glow: rgba(88,200,120,0.14);
  --correct-strong: rgba(88,200,120,0.22);
  --wrong-glow: rgba(230,80,80,0.12);
  --wrong-strong: rgba(230,80,80,0.20);
  --card-border: rgba(255,255,255,0.04);
  --glass: rgba(255,255,255,0.02);
  --shadow: 0 10px 30px rgba(0,0,0,0.6);
  --radius: 12px;
  --gap: 12px;
  --max-width: 920px;
}

/* Reset and layout */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family: Inter, system-ui, Arial, sans-serif;
  background:linear-gradient(180deg,var(--bg) 0%, #020203 100%);
  color:var(--card-ink);
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}

/* Center wrapper */
.quiz-wrapper{
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:32px;
}

/* Card */
.quiz-card{
  width:100%;
  max-width:var(--max-width);
  background:linear-gradient(180deg,var(--card-bg), rgba(10,12,14,0.96));
  border-radius:var(--radius);
  border:1px solid var(--card-border);
  padding:22px;
  box-shadow:var(--shadow);
  transform-origin:center;
  transition:transform 320ms cubic-bezier(.2,.9,.25,1), opacity 220ms;
}

/* Header */
.quiz-header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:var(--gap);
  margin-bottom:18px;
}
.mode-label{font-weight:600; color:var(--muted); font-size:14px}
.q-number{font-weight:700; color:var(--muted); font-size:14px}
.timer{font-weight:700; color:var(--muted); font-size:14px}

/* Question block */
.question-block{
  background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  border-radius:10px;
  padding:18px;
  border:1px solid rgba(255,255,255,0.02);
}

/* Question text */
.q-text{
  font-size:20px;
  font-weight:600;
  line-height:1.35;
  margin-bottom:14px;
  color:var(--card-ink);
}

/* Options list */
.options-box{
  display:flex;
  flex-direction:column;
  gap:12px;
}

/* Option style */
.option{
  background:var(--glass);
  border-radius:10px;
  padding:12px 14px;
  cursor:pointer;
  border:1px solid rgba(255,255,255,0.03);
  transition:box-shadow 180ms, transform 180ms, background 180ms, border-color 180ms;
  display:flex;
  align-items:flex-start;
  gap:12px;
  color:var(--card-ink);
  user-select:none;
  position:relative;
  overflow:hidden;
}

/* Option label */
.option .label{
  min-width:34px;
  font-weight:700;
  display:inline-block;
  color:var(--muted);
}

/* Soft blue hover */
.option:hover{
  background:var(--accent-hover);
  box-shadow:0 6px 20px rgba(40,80,160,0.06);
  transform:translateY(-4px);
  border-color:var(--accent-hover-strong);
}

/* Selected visual */
.option.selected{
  background:var(--accent-hover-strong);
  box-shadow:0 8px 30px rgba(40,80,160,0.08);
  border-color:rgba(100,160,255,0.28);
}

/* Correct and wrong states */
.option.correct{
  background:linear-gradient(90deg, var(--correct-glow), rgba(255,255,255,0.01));
  box-shadow:0 8px 28px rgba(88,200,120,0.12);
  border-color:rgba(88,200,120,0.28);
  color: #eafaf0;
}
.option.wrong{
  background:linear-gradient(90deg, var(--wrong-glow), rgba(255,255,255,0.01));
  box-shadow:0 8px 28px rgba(230,80,80,0.10);
  border-color:rgba(230,80,80,0.28);
  color:#ffecec;
}

/* Small badge for correctness */
.option .status{
  margin-left:auto;
  padding:6px 8px;
  border-radius:8px;
  font-weight:700;
  font-size:13px;
  color:inherit;
  display:inline-flex;
  align-items:center;
  gap:6px;
}

/* Buttons row */
.btn-row{
  display:flex;
  gap:12px;
  margin-top:14px;
}

/* General button */
.btn{
  background:transparent;
  color:var(--card-ink);
  border:1px solid rgba(255,255,255,0.04);
  padding:10px 14px;
  border-radius:8px;
  cursor:pointer;
  font-weight:700;
  transition:all 200ms;
}

/* Validate button high */
.validate-btn{
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.00));
  border-color: rgba(100,160,255,0.18);
}
.validate-btn:hover{ box-shadow:0 10px 30px rgba(100,160,255,0.06); transform:translateY(-3px); }

/* More details button */
.more-btn{ border-color: rgba(255,255,255,0.04); color:var(--muted) }

/* Nav buttons */
.btn-nav{
  display:flex;
  gap:10px;
  margin-top:18px;
  justify-content:flex-end;
}

/* Submit and next */
.next-btn{ background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00)); }
.next-btn:hover{ box-shadow:0 10px 30px rgba(100,160,255,0.05); transform:translateY(-3px); }

/* Solution panel */
.solution-box{
  margin-top:14px;
  background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  border-radius:10px;
  padding:12px;
  max-height:220px;
  overflow:auto;
  border:1px solid rgba(255,255,255,0.02);
  scrollbar-width:thin;
}
.solution-box::-webkit-scrollbar{ height:8px; width:8px; }
.solution-box::-webkit-scrollbar-thumb{ background:rgba(255,255,255,0.04); border-radius:6px; }

/* Resource link buttons */
.resource-links{ display:flex; gap:10px; margin-top:10px; align-items:center; }
.link-btn{
  display:inline-flex; align-items:center; gap:8px; padding:8px 10px; border-radius:8px;
  background:rgba(255,255,255,0.02); border:1px solid rgba(255,255,255,0.03); color:var(--card-ink); text-decoration:none;
}
.yt-btn{ background:transparent; border:1px solid rgba(255,255,255,0.03); color:#fff; padding:8px 10px; border-radius:8px; text-decoration:none; display:inline-flex; align-items:center; gap:8px; }
.yt-icon{ display:inline-block; width:18px; height:18px; background:#e53935; border-radius:4px; color:#fff; font-size:13px; display:flex; align-items:center; justify-content:center; }

/* Result card */
.result-card{
  max-width:720px;
  background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  border-radius:12px;
  padding:20px;
  text-align:center;
  box-shadow:var(--shadow);
  border:1px solid rgba(255,255,255,0.03);
}

/* Confetti canvas */
.confetti{ position:fixed; inset:0; pointer-events:none; z-index:9999; }

/* Hidden util */
.hidden{ display:none !important; }

/* Animations for card transitions */
@keyframes slideLeftOut {
  0%{ transform:translateX(0) scale(1); opacity:1; }
  60%{ transform:translateX(-12%) scale(0.96); opacity:0.95; }
  100%{ transform:translateX(-120%) scale(0.9); opacity:0; }
}
@keyframes slideRightIn {
  0%{ transform:translateX(120%) scale(0.9); opacity:0; }
  60%{ transform:translateX(12%) scale(0.96); opacity:0.95; }
  100%{ transform:translateX(0) scale(1); opacity:1; }
}
@keyframes slideRightOut {
  0%{ transform:translateX(0) scale(1); opacity:1; }
  60%{ transform:translateX(12%) scale(0.96); opacity:0.95; }
  100%{ transform:translateX(120%) scale(0.9); opacity:0; }
}
@keyframes slideLeftIn {
  0%{ transform:translateX(-120%) scale(0.9); opacity:0; }
  60%{ transform:translateX(-12%) scale(0.96); opacity:0.95; }
  100%{ transform:translateX(0) scale(1); opacity:1; }
}

/* helper classes to trigger animations */
.anim-out-left{ animation: slideLeftOut 420ms cubic-bezier(.2,.9,.25,1) forwards; }
.anim-in-right{ animation: slideRightIn 420ms cubic-bezier(.2,.9,.25,1) forwards; }
.anim-out-right{ animation: slideRightOut 420ms cubic-bezier(.2,.9,.25,1) forwards; }
.anim-in-left{ animation: slideLeftIn 420ms cubic-bezier(.2,.9,.25,1) forwards; }

/* Responsive tweaks */
@media (max-width:700px){
  .quiz-card{ padding:16px; margin:12px; border-radius:10px; }
  .q-text{ font-size:18px }
  .option{ padding:10px }
  .solution-box{ max-height:180px }
}
/* ==== PASTE YOUR CSS HERE ==== */
:root{
  --bg:#060606;
  --card-bg:#0f1113;
  --card-ink:#e6eef2;
  --muted:#a9b0b6;
  --accent-hover: rgba(100,160,255,0.12);
  --accent-hover-strong: rgba(100,160,255,0.22);
  --correct-glow: rgba(88,200,120,0.14);
  --correct-strong: rgba(88,200,120,0.22);
  --wrong-glow: rgba(230,80,80,0.12);
  --wrong-strong: rgba(230,80,80,0.20);
  --card-border: rgba(255,255,255,0.04);
  --glass: rgba(255,255,255,0.02);
  --shadow: 0 10px 30px rgba(0,0,0,0.6);
  --radius: 12px;
  --gap: 12px;
  --max-width: 920px;
}
/* Mode selection card */
.mode-card{
  background: linear-gradient(180deg, var(--card-bg), rgba(10,12,14,0.96));
  border-radius: var(--radius);
  border: 1px solid var(--card-border);
  padding: 24px;
  text-align: center;
  max-width: 480px;
  margin: auto;
  box-shadow: var(--shadow);
  animation: slideRightIn 420ms cubic-bezier(.2,.9,.25,1) forwards;
}

.mode-title{
  font-size: 22px;
  font-weight: 700;
  color: var(--card-ink);
  margin-bottom: 20px;
}

.mode-options{
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.mode-btn{
  background: var(--glass);
  color: var(--card-ink);
  border: 1px solid rgba(255,255,255,0.03);
  padding: 14px 18px;
  font-weight: 700;
  border-radius: var(--radius);
  cursor: pointer;
  transition: all 200ms;
  font-size: 16px;
}

.mode-btn:hover{
  background: var(--accent-hover);
  box-shadow: 0 8px 28px rgba(100,160,255,0.12);
  transform: translateY(-4px);
  border-color: var(--accent-hover-strong);
}
</style>
</head>
<body>

<div class="quiz-wrapper">
  <div class="quiz-card">
    <div class="quiz-header">
      <div class="title" id="quizTitle">Loading Quiz...</div>
      <div class="timer" id="timer"></div>
    </div>
    
  <div id="modeSelect" class="mode-card">
  <h2 class="mode-title">Choose Quiz Mode</h2>
  <div class="mode-options">
    <button class="mode-btn" onclick="startPractice()">Practice Mode</button>
    <button class="mode-btn" onclick="startMock()">Mock Test</button>
  </div>
</div>

    <div class="question-block hidden" id="questionBlock">
      <div class="q-text" id="questionText"></div>
      <div class="options-box" id="optionsContainer"></div>
      <div class="btn-row" id="btnRow">
        <button class="btn validate-btn" id="validateBtn" onclick="validateAnswer()">Validate</button>
        <button class="btn" onclick="prevQuestion()">Prev</button>
        <button class="btn" onclick="nextQuestion()">Next</button>
      </div>
      <div class="solution-box hidden" id="solutionPanel">
        <div id="solutionText"></div>
        <div class="resource-links">
          <a href="#" target="_blank" id="youtubeLink" class="link-btn">YouTube</a>
          <a href="#" target="_blank" id="pdfLink" class="link-btn">PDF</a>
        </div>
      </div>
    </div>

    <div class="solution-box hidden" id="resultPanel"></div>
  </div>
</div>

<script>
const urlParams = new URLSearchParams(window.location.search);
const paperFile = urlParams.get("paper");
const year = urlParams.get("year");

let questions = [];
let currentIndex = 0;
let score = 0;
let selectedOption = null;
let mode = null;
let timerInterval;
let timeLeft = 0;

async function loadQuizFile() {
    try {
        const res = await fetch(`json/${paperFile}_${year}.json`);
        if (!res.ok) throw new Error("JSON not found");
        const data = await res.json();
        document.getElementById("quizTitle").textContent = data.title || "Quiz";
        questions = data.questions;
    } catch(err){
        alert("Failed to load quiz file");
        console.error(err);
    }
}

function startPractice(){
    mode="practice";
    document.getElementById("modeSelect").classList.add("hidden");
    document.getElementById("questionBlock").classList.remove("hidden");
    document.getElementById("validateBtn").style.display="inline-block";
    loadQuestion();
}

function startMock(){
    mode="mock";
    document.getElementById("modeSelect").classList.add("hidden");
    document.getElementById("questionBlock").classList.remove("hidden");
    document.getElementById("validateBtn").style.display="none";

    let mins = prompt("Enter timer in minutes", "60");
    timeLeft = parseInt(mins)*60;
    startTimer();
    loadQuestion();
}

function startTimer(){
    timerInterval = setInterval(()=>{
        if(timeLeft<=0){
            clearInterval(timerInterval);
            submitQuiz();
            return;
        }
        const m=Math.floor(timeLeft/60);
        const s=timeLeft%60;
        document.getElementById("timer").textContent=`Time Left: ${m}m ${s}s`;
        timeLeft--;
    },1000);
}

function loadQuestion(){
    const q=questions[currentIndex];
    const optionsBox=document.getElementById("optionsContainer");
    document.getElementById("questionText").textContent = q.question;
    optionsBox.innerHTML="";
    selectedOption=null;

    for(let key of ['a','b','c','d']){
        if(!q.options[key]) continue;
        const btn=document.createElement("div");
        btn.className="option";
        btn.innerHTML=`<span class="label">${key.toUpperCase()}.</span> ${q.options[key]}`;
        btn.onclick=()=>{
            selectedOption=key;
            optionsBox.querySelectorAll('.option').forEach(o=>o.classList.remove("selected"));
            btn.classList.add("selected");
        };
        optionsBox.appendChild(btn);
    }
    document.getElementById("solutionPanel").classList.add("hidden");
}

function validateAnswer(){
    if(!selectedOption) { alert("Select an option"); return; }
    const q=questions[currentIndex];
    const opts=document.getElementById("optionsContainer").children;
    for(let i=0;i<opts.length;i++){
        const key=Object.keys(q.options)[i];
        opts[i].classList.remove("correct","wrong");
        if(key===q.correct) opts[i].classList.add("correct");
        else if(key===selectedOption) opts[i].classList.add("wrong");
    }
    if(selectedOption===q.correct) score++;
    const sol=document.getElementById("solutionText");
    sol.textContent=q.solution || "";
    const yt=document.getElementById("youtubeLink");
    const pdf=document.getElementById("pdfLink");
    yt.href=q.youtube || "#";
    pdf.href=q.pdf || "#";
    document.getElementById("solutionPanel").classList.remove("hidden");
}

function nextQuestion(){
    if(currentIndex<questions.length-1){
        currentIndex++;
        loadQuestion();
    }else if(mode==="mock"){
        submitQuiz();
    }
}

function prevQuestion(){
    if(currentIndex>0){
        currentIndex--;
        loadQuestion();
    }
}

function submitQuiz(){
    if(mode==="mock") clearInterval(timerInterval);
    document.getElementById("questionBlock").classList.add("hidden");
    const rp=document.getElementById("resultPanel");
    rp.classList.remove("hidden");
    rp.innerHTML=`<h3>Score: ${score} / ${questions.length}</h3>`;
}

loadQuizFile();
</script>
<!-- Add MathJax here -->
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>      </div>
      <div id="solutionPanel" class="mt-2 hidden" style="padding:14px; border-radius:10px; background:rgba(255,255,255,0.03);">
        <div style="font-weight:700; margin-bottom:8px;">Solution</div>
        <div id="solutionText" class="muted"></div>
        <a href="#" target="_blank" id="youtubeLink" class="btn mt-2" style="display:none;">Watch Video Solution</a>
      </div>
      <div class="flex gap-2 mt-2">
        <button class="btn" onclick="prevQuestion()">Previous</button>
        <button class="btn btn-primary" onclick="nextQuestion()">Next</button>
        <button class="btn btn-success" onclick="submitQuiz()" id="submitBtn">Submit Test</button>
      </div>
    </div>
  </div>

  <div id="resultContainer" class="hidden text-center card">
    <div style="font-size:24px; font-weight:700; margin-bottom:8px;">Test Submitted!</div>
    <div id="scoreDisplay" style="font-size:20px; margin-bottom:8px;"></div>
    <div id="percentageDisplay" style="font-size:18px; margin-bottom:12px;"></div>
    <button class="btn btn-primary" onclick="goHome()">Go Home</button>
  </div>
</div>

<canvas id="confettiCanvas" class="confetti"></canvas>

<script>
// Mock Data (admin adds these)
const quizMode = 'practice'; // 'practice' or 'mock'
const questions = [
  {
    id:'q1', questionNumber:1, questionText:'What is 2+2?', 
    optionA:'3', optionB:'4', optionC:'5', optionD:'6',
    correctAnswer:'B', solution:'2+2=4', youtubeUrl:'https://www.youtube.com/'
  },
  {
    id:'q2', questionNumber:2, questionText:'Capital of Meghalaya?', 
    optionA:'Shillong', optionB:'Guwahati', optionC:'Kohima', optionD:'Imphal',
    correctAnswer:'A', solution:'Shillong is the capital', youtubeUrl:''
  }
];

let currentIndex = 0;
let answers = {};
let validated = {};
let showSolution = false;
let timerMinutes = quizMode==='mock'?60:0;
let timeRemaining = 0;
let timerInterval = null;

const modeLabel = document.getElementById('modeLabel');
const qNumber = document.getElementById('qNumber');
const questionText = document.getElementById('questionText');
const optionsContainer = document.getElementById('optionsContainer');
const solutionPanel = document.getElementById('solutionPanel');
const solutionText = document.getElementById('solutionText');
const toggleSolutionBtn = document.getElementById('toggleSolutionBtn');
const youtubeLink = document.getElementById('youtubeLink');
const timerDisplay = document.getElementById('timerDisplay');

function loadQuestion() {
  const q = questions[currentIndex];
  qNumber.textContent = `Q ${currentIndex+1} / ${questions.length}`;
  questionText.textContent = `${q.questionNumber}. ${q.questionText}`;
  optionsContainer.innerHTML='';
  ['A','B','C','D'].forEach(option=>{
    const optText = q['option'+option];
    const div = document.createElement('div');
    div.className='card card-interactive';
    div.style.padding='14px'; div.style.border='1px solid var(--border)'; div.style.borderRadius='10px';
    if(answers[q.id]===option) div.classList.add('selected');
    if(validated[q.id]){
      if(option===q.correctAnswer) div.classList.add('correct');
      if(answers[q.id]===option && answers[q.id]!==q.correctAnswer) div.classList.add('wrong');
    }
    div.innerHTML=`<strong>${option})</strong> ${optText}`;
    div.onclick=()=>{ selectOption(option); };
    optionsContainer.appendChild(div);
  });
  solutionPanel.classList.add('hidden');
  toggleSolutionBtn.style.display=validated[q.id]?'inline-block':'none';
  solutionText.textContent = q.solution || 'No solution provided';
  if(q.youtubeUrl) { youtubeLink.href=q.youtubeUrl; youtubeLink.style.display='inline-flex'; } else youtubeLink.style.display='none';
}

function selectOption(option){ answers[questions[currentIndex].id]=option; loadQuestion(); }

function validateAnswer(){ 
  const q=questions[currentIndex];
  if(!answers[q.id]) { alert('Please select an option'); return; }
  validated[q.id]=true;
  if(quizMode==='practice') showSolution=true;
  loadQuestion();
}

function toggleSolution(){ showSolution=!showSolution; solutionPanel.classList.toggle('hidden',!showSolution); }

function nextQuestion(){ if(currentIndex<questions.length-1){ currentIndex++; showSolution=false; loadQuestion(); } else alert('Last question'); }
function prevQuestion(){ if(currentIndex>0){ currentIndex--; showSolution=false; loadQuestion(); } }

function startTimer(minutes){ timerMinutes=minutes; timeRemaining=minutes*60; document.getElementById('timerSelection').classList.add('hidden'); document.getElementById('quizContainer').classList.remove('hidden'); startCountdown(); loadQuestion(); }
function startCountdown(){
  timerInterval=setInterval(()=>{
    if(timeRemaining<=0){ clearInterval(timerInterval); submitQuiz(); return; }
    timeRemaining--; const m=Math.floor(timeRemaining/60); const s=timeRemaining%60;
    timerDisplay.textContent=`${m}:${s<10?'0'+s:s}`;
  },1000);
}

function submitQuiz(){
  clearInterval(timerInterval);
  let score=0;
  questions.forEach(q=>{
    const ans=answers[q.id];
    if(ans===q.correctAnswer) score+=2;
    else if(ans && ans!==q.correctAnswer) score-=0.5;
  });
  if(score<0) score=0;
  const maxScore=questions.length*2;
  const percentage=((score/maxScore)*100).toFixed(2);
  document.getElementById('quizContainer').classList.add('hidden');
  const res=document.getElementById('resultContainer');
  res.classList.remove('hidden');
  document.getElementById('scoreDisplay').textContent=`Score: ${score}/${maxScore}`;
  document.getElementById('percentageDisplay').textContent=`Percentage: ${percentage}%`;
  startConfetti();
}

function goHome(){ location.href='homepage.html'; }

// Initialize
if(quizMode==='mock'){ document.getElementById('timerSelection').classList.remove('hidden'); } else { document.getElementById('quizContainer').classList.remove('hidden'); loadQuestion(); }

// Confetti Animation
const confettiCanvas = document.getElementById('confettiCanvas');
const ctx = confettiCanvas.getContext('2d');
confettiCanvas.width = window.innerWidth; confettiCanvas.height = window.innerHeight;
let confettiParticles=[];
function createConfetti(){ for(let i=0;i<150;i++){ confettiParticles.push({x:Math.random()*confettiCanvas.width,y:Math.random()*confettiCanvas.height,r:Math.random()*6+4,dx:(Math.random()-0.5)*5,dy:Math.random()*5,color:`hsl(${Math.random()*360},70%,50%)`}); } }
function drawConfetti(){ ctx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height); confettiParticles.forEach(p=>{ ctx.fillStyle=p.color; ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,Math.PI*2); ctx.fill(); p.x+=p.dx; p.y+=p.dy; if(p.y>confettiCanvas.height){ p.y=0; p.x=Math.random()*confettiCanvas.width; } }); requestAnimationFrame(drawConfetti); }
function startConfetti(){ createConfetti(); drawConfetti(); setTimeout(()=>{ confettiParticles=[]; ctx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height); },5000); }
</script>
</body>
</html>
